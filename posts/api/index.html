<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Creating a Go API - Brain Dump</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content><meta property="og:site_name" content="Brain Dump"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://estensen.github.io/posts/api/"><meta property="og:title" content="Creating a Go API"><meta property="og:image" content="https://estensen.github.io"><meta property="og:description" content><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Creating a Go API"><meta name=twitter:description content><meta name=twitter:image content="https://estensen.github.io"><link rel=canonical href=https://estensen.github.io/posts/api/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin=anonymous><link rel=stylesheet href=https://estensen.github.iocss/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin=anonymous><link rel="shortcut icon" href=https://estensen.github.ioimages/favicon.png><link href=https://estensen.github.io/index.xml rel=alternate type=application/rss+xml title="Brain Dump"></head><body><div class="mt-xl header"><div class=container><div class="row justify-content-center"><div class=col-auto><a href=https://estensen.github.io><h1 class=name>Brain Dump</h1></a></div></div><div class="row justify-content-center"><ul class="nav nav-primary"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=https://github.com/estensen>GitHub</a></li></ul></div></div></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4">Creating a Go API</h1><div class=markdown><p>Often creating a service starts with defining an API. HTTP is the most common way of defining a way for a client to interact with service data. A browser can issue a request, ask the server to do something, by sending an HTTP method and a resource path. For example <code>GET /answer</code>. The server then has to match this request to its server logic. This is what the request router is for.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#00f>package</span> main

<span style=color:#00f>import</span> (
	<span style=color:#a31515>&#34;fmt&#34;</span>
	<span style=color:#a31515>&#34;log&#34;</span>
	<span style=color:#a31515>&#34;net/http&#34;</span>
)

<span style=color:#00f>func</span> answerHandler(w http.ResponseWriter, r *http.Request) {
	fmt.Println(<span style=color:#a31515>&#34;Client asked for answer&#34;</span>)
	fmt.Fprintf(w, <span style=color:#a31515>&#34;42&#34;</span>)
}

<span style=color:#00f>func</span> main() {
	http.HandleFunc(<span style=color:#a31515>&#34;/answer&#34;</span>, answerHandler)
	log.Fatal(http.ListenAndServe(<span style=color:#a31515>&#34;:8080&#34;</span>, <span style=color:#00f>nil</span>))
}
</code></pre></div><p><code>HandleFunc</code> registers the handler function <code>answerHandler</code> on the router.</p><p><code>ListenAndServe</code> listenes for TCP connections and calls <code>Serve</code> with a handler to handle incoming connections. <code>Serve</code> creates a goroutine, a lightweight thread, for each requests, which enables the API to handle lots of concurrent requests. The second argument for <code>ListenAndServe</code> defines the request multiplexer, used to match the request to the list of registered routes. When this is <code>nil</code> the <code>DefaultServeMux</code> is used.</p></div></div></div></div></div><section id=comments><div class="py-3 content"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><div class=comments><script src=https://utteranc.es/client.js repo issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div></div></section><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/go.min.js defer></script><script>window.addEventListener('load',function(){hljs.initHighlighting()},!0)</script></body></html>